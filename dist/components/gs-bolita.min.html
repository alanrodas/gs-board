<dom-module id="gs-bolita"><template><style>:host .container{margin:1px;width:18px;height:18px;float:left}:host .container .ball{width:18px;height:18px;display:block;border-radius:9px;float:left;font-weight:bold;background-size:100% 100%;background-position:center center;background-repeat:no-repeat}:host .container .ball.negro{background-image:url("../assets/bolita/black.png");background-color:#111;color:#FFF}:host .container .ball.azul{background-image:url("../assets/bolita/blue.png");background-color:#11F;color:#FFF}:host .container .ball.rojo{background-image:url("../assets/bolita/red.png");background-color:#F11;color:#FFF}:host .container .ball.verde{background-image:url("../assets/bolita/green.png");background-color:#014F00;color:#FFF}:host .container .ball.unknow{background-color:#888}:host .container .ball *{box-sizing:content-box}:host .container .ball .amount{cursor:default;display:flex;font-size:16px;line-height:18px;justify-content:center;align-items:center}:host.two-digits .container .ball .amount{font-size:12px;line-height:18px}</style><div class="container"><template is="dom-if" if="{{amount}}"><div class$="ball {{color}}" title$="{{ballTitle}}"><span class="amount">{{amountView}}</span></div></template></div></template><script>Polymer({is:"gs-bolita",properties:{color:{type:String,value:"unknow"},amountView:{type:String,value:"",observer:"_amount_view_change"},amount:{type:Number,value:0,notify:!0,observer:"_amount_change"},cell:{type:Object,observer:"_update_amount"},twoDigits:{type:Object,observer:"_two_digits_change"},editable:{type:Object,observer:"_editable_change"},ballTitle:{type:String,value:"NaN:NaN"},rowIndex:{type:Number,value:0,observer:"_update_title"},columnIndex:{type:Number,value:0,observer:"_update_title"},observers:["_update_amount(cell.*)"]},ready:function(){return this._update_amount(),this._addObserverEffect()},attached:function(){return this.editable&&this._editable_change(!0),this._update_title(),this.process_two_digits()},_update_amount:function(){return this.amount=this.cell[this.color]},detached:function(){return this.editable&&this._editable_change(!1)},_editable_change:function(a){return a?(this.listen(this,"mousedown","_mousedown"),this.listen(this,"contextmenu","_prevent_default")):(this.unlisten(this,"mousedown","_mousedown"),this.unlisten(this,"contextmenu","_prevent_default"))},_amount_change:function(){return"number"==typeof this.amount&&this.amount>=0||(this.amount=0),this.cell&&(this.cell[this.color]=this.amount),this.amountView=this.amount>99?"+":this.amount,this._update_title()},_two_digits_change:function(){return this.twoDigits?this.classList.add("two-digits"):this.classList.remove("two-digits")},process_two_digits:function(){return this.amount>9?this.twoDigits=!0:void 0},_amount_view_change:function(){return this.amount>9&&(this.twoDigits=!0),this.amount<=9?this.twoDigits=!1:void 0},_update_title:function(){return this.ballTitle="["+this.rowIndex+":"+this.columnIndex+"] - "+this.color+"["+this.amount+"]"},_prevent_default:function(a){return a.preventDefault(),!1},_mousedown:function(a){var b,c,d;return 3===a.which?(a.preventDefault(),this.amount-=1):1===a.which?(b={item:this},c=function(a){return function(c){return a.make_move(b,c)}}(this),d=function(a){return function(e){return 1===e.which?(a.finish_move(b,e),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",d)):void 0}}(this),window.addEventListener("mouseup",d),window.addEventListener("mousemove",c)):void 0},init_move:function(a,b){return a.initial_mouse_x=b.clientX,a.initial_mouse_y=b.clientY},make_move:function(a,b){return a.move=!0},finish_move:function(a,b){return a.move?void 0:this.amount+=1}});</script></dom-module>