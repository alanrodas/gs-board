<dom-module id="gs-stone">
  <template>
    <style>
      .pointer {
        cursor: pointer;
      }

      .unselectable, .gbs_stone {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      ::content div.blue {
        background: radial-gradient(circle at 20px 20px, #122286, #0a37d0);
      }
      ::content div.black {
        background: radial-gradient(circle at 20px 20px, #4a4a4a, #000000);
      }
      ::content div.red {
        background: radial-gradient(circle at 20px 20px, #a91f1f, #a60000);
      }
      ::content div.green {
        background: radial-gradient(circle at 20px 20px, #54984b, #0b6600);
      }
      ::content div.O {
        background: white;
        opacity: 0;
      }

      .gbs_stone {
        position: relative;
        font-weight: bold;
        font-size: 8pt;
        width: 20px;
        height: 20px;
        border-radius: 50%;
      }

      .gbs_stone:before {
        content: "";
        position: absolute;
        top: 1%;
        left: 5%;
        width: 90%;
        height: 90%;
        border-radius: 50%;
        background: radial-gradient(circle at 50% 0px, #ffffff, rgba(255, 255, 255, 0) 58%);
        filter: blur(5px);
        z-index: 2;
      }

      .stone_amount {
        vertical-align: sub;
      }

      /*# sourceMappingURL=style.css.map */

    </style>

    <template is="dom-if" if="{{amount}}">
      <div class$="gbs_stone {{color}} {{cssClass()}}">
        <span class="stone_amount">{{amount}}</span>
      </div>
    </template>

    <template is="dom-if" if="{{!amount}}">
      <div class$="gbs_stone O {{cssClass()}}"></div>
    </template>

  </template>
  <script>
    Polymer({
      is: 'gs-stone',
      properties: {
        color: String,
        amount: {
          type: Number,
          value: 0,
          notify: true,
          observer: "_sanitizeAmount"
        },
        options: Object
      },
      listeners: {
        click: "_leftClick",
        contextmenu: "_rightClick"
      },
      ready: function() {
        this._sanitizeAmount();
        if (this.options == null) {
          throw new Error("The options are required");
        }
      },
      cssClass: function() {
        if (this.options.editable) {
          return "pointer";
        } else {
          return "";
        }
      },
      _sanitizeAmount: function() {
        if (!(typeof this.amount === "number" && this.amount >= 0)) {
          return this.amount = 0;
        }
      },
      _leftClick: function(event) {
        var board;
        board = this.domHost.domHost;
        if (!this.options.editable || board.isCtrlPressed()) {
          return;
        }
        this.fire("board-changed");
        this.amount += 1;
        return event.stopPropagation();
      },
      _rightClick: function(event) {
        if (!this.options.editable) {
          return;
        }
        event.preventDefault();
        this.fire("board-changed");
        return this.amount -= 1;
      }
    });

  </script>
</dom-module>